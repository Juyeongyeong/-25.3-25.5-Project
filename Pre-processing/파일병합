import os
import pandas as pd

dirpath = os.path.expanduser("~/Downloads/ì¼ìë¦¬")
if not dirpath.endswith('/'):
    dirpath += '/'

files = os.listdir(dirpath)
print("ğŸ“‚ íŒŒì¼ ëª©ë¡:", files)

# âœ… ì—¬ê¸°ì„œ ë¨¼ì € ë¹ˆ DataFrame ìƒì„±!
raw = pd.DataFrame()

for file in files:
    fpath = dirpath + file
    print(f"ğŸ“„ í˜„ì¬ ì²˜ë¦¬ ì¤‘ì¸ íŒŒì¼: {fpath}")

    if os.path.exists(fpath):
        try:
            temp = pd.read_csv(fpath)
        except UnicodeDecodeError:
            temp = pd.read_csv(fpath, encoding='cp949')
        
        raw = pd.concat([raw, temp], ignore_index=True)
    else:
        print(f"âš ï¸ íŒŒì¼ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤: {fpath}")

print("âœ… ë³‘í•© ì™„ë£Œ!")
raw.to_csv('ë³‘í•©ì™„ë£Œ.csv', encoding = 'utf-8-sig')
